# 标注界面 - 原型设计 ⭐

> **页面路径**: `/audio/:id/annotate`
> **优先级**: P0
> **访问角色**: 标注员、审核员

---

## 页面布局

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│ 顶部工具栏                                                                          │
│ ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│ │ meeting001.mp3 | 1:23:45 | [▶播放] [⏸暂停] [⏹停止] [速度:1.0x▼] [🔊] [💾已保存] │ │
│ │ [上一段] [下一段] | A:[00:15.230] B:[00:45.670] | [取消循环] | [提交审核]      │ │
│ └─────────────────────────────────────────────────────────────────────────────────┘ │
├────────────────┬────────────────────────────────────────────────────────────────────┤
│                │  分段导航面板（长音频）                                               │
│                │  ┌──────────────────────────────────────────────────────────────┐  │
│                │  │ 00:00 - 00:15  [会议开始]                                    │  │
│                │  │ 00:15 - 00:45  [自我介绍]                                    │  │
│                │  │ 00:45 - 01:30  [项目讨论]                                    │  │
│                │  │ 01:30 - 02:00  [问题答疑]                                    │  │
│                │  └──────────────────────────────────────────────────────────────┘  │
│                │                                                                      │
│  右侧面板      │  波形显示区                                                           │
│  ┌──────────┐  │  ┌──────────────────────────────────────────────────────────────┐  │
│  │ 标注列表 │  │  │ [◀] 00:00 ─────────────────────────────────── 01:23:45 [▶]    │  │
│  ├──────────┤  │  │                                                              │  │
│  │1. 00:15-  │  │  │    │▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌│    │
│  │   00:45   │  │  │    │   [标注1]        [标注2]        [标注3]  │    │
│  │   大家好  │  │  │    │   说话人1        说话人2               │    │
│  │   🏷️3个   │  │  │    │   00:15-00:45    00:46-01:10    01:11-01:30│    │
│  │   👤张三   │  │  │    ▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌│    │
│  │   [编辑]  │  │  │                                                              │  │
│  ├──────────┤  │  │    协作者光标: [李四] [王五]                                │  │
│  │2. 00:46-  │  │  │    评论标记: 💬                                           │  │
│  │   01:10   │  │  │                                                              │  │
│  │   今天我...│  │  │                                                              │  │
│  │   🏷️2个   │  │  │                                                              │  │
│  │   👤李四   │  │  │                                                              │  │
│  ├──────────┤  │  │                                                              │  │
│  │ [+新建]   │  │  └──────────────────────────────────────────────────────────────┘  │
│  ├──────────┤  │                                                                      │
│  │标注层管理 │  │  底部面板                                                            │
│  │☑转写层   │  │  ┌──────────────────────────────────────────────────────────────┐  │
│  │☑说话人层 │  │  │ 热力图: [标注密度▼] [说话人分布▼] [频谱▼]                    │  │
│  │☑情感层   │  │  │ ▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂    │  │
│  │☑事件层   │  │  └──────────────────────────────────────────────────────────────┘  │
│  │[+新建层] │  │                                                                      │
│  ├──────────┤  │                                                                      │
│  │说话人列表 │  │  播放进度条                                                          │
│  │👤张三(蓝) │  │  00:15.230 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 01:23:450   │
│  │👤李四(绿) │  │  ████████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  │[+新建]   │  │                                                                      │
│  ├──────────┤  │                                                                      │
│  │AI处理进度 │  │                                                                      │
│  │🔄 ASR    │  │                                                                      │
│  │ 85%      │  │                                                                      │
│  │[查看详情]│  │                                                                      │
│  ├──────────┤  │                                                                      │
│  │在线协作   │  │                                                                      │
│  │[头像]张三 │  │                                                                      │
│  │[头像]李四 │  │                                                                      │
│  │[头像]王五 │  │                                                                      │
│  └──────────┘  │                                                                      │
│                │                                                                      │
└────────────────┴──────────────────────────────────────────────────────────────────────┘
```

---

## 组件清单

| 组件名称 | 类型 | 数量 | 说明 |
|---------|------|------|------|
| 顶部工具栏 | Toolbar | 1 | 播放控制和操作工具 |
| 分段导航 | List | 1 | 长音频分段导航 |
| 波形显示区 | Waveform | 1 | 音频波形和标注显示 |
| 标注列表 | List | 1 | 标注列表 |
| 标注层管理 | Panel | 1 | 标注层管理面板 |
| 说话人列表 | List | 1 | 说话人列表 |
| AI 处理进度 | Progress | 1 | AI 处理进度 |
| 在线协作 | Avatar List | 1 | 在线协作者 |
| 热力图 | Heatmap | 1 | 标注热力图 |
| 播放进度条 | Progress | 1 | 播放进度 |

---

## 组件详细说明

### 1. 顶部工具栏

**高度**: 56px

**左侧**: 音频信息

| 项目 | 说明 |
|------|------|
| 文件名 | meeting001.mp3 |
| 时长 | 1:23:45 |

**中间**: 播放控制

| 按钮 | 图标 | 快捷键 | 功能 |
|------|------|--------|------|
| 播放 | ▶ | 空格 | 播放音频 |
| 暂停 | ⏸ | 空格 | 暂停播放 |
| 停止 | ⏹ | Esc | 停止播放 |
| 上一段 | ◀ | Shift+← | 跳转到上一段标注 |
| 下一段 | ▶ | Shift+→ | 跳转到下一段标注 |

**右侧**: 播放设置

| 组件 | 说明 |
|------|------|
| 速度选择 | 0.5x、0.75x、1.0x、1.25x、1.5x、2.0x |
| 音量控制 | 音量图标 + 滑块 |
| 保存状态 | 已保存 / 未保存 |
| 提交审核 | 提交当前标注到审核 |

**循环播放**:
- A 点: 设置循环起始点（Ctrl+A）
- B 点: 设置循环结束点（Ctrl+B）
- 取消循环: 取消循环播放（Ctrl+Shift+A）

### 2. 分段导航面板（长音频）

**显示条件**: 音频时长 ≥ 30分钟

**内容**:
- 分段时间范围
- 分段标题（AI 生成或手动编辑）
- 分段摘要（AI 生成）

**交互**:
- 点击分段跳转到对应时间
- 右键编辑分段信息
- 拖拽调整分段顺序

**样式**:
- 当前播放分段高亮
- 未播放分段灰色

### 3. 波形显示区 ⭐ 核心组件

**功能**:
- 显示音频波形
- 显示标注色块
- 显示协作者光标
- 显示评论标记
- 支持 A-B 循环标记

**交互**:

| 操作 | 功能 |
|------|------|
| 点击波形 | 跳转到对应时间 |
| 拖拽选区 | 创建/调整标注 |
| 滚轮 | 缩放波形 |
| 拖动波形 | 平移视图 |
| 双击 | 播放/暂停 |
| 右键 | 打开上下文菜单 |

**标注色块**:
- 颜色: 根据标注层或说话人
- 边框: 标注边界
- 悬停: 显示标注信息

**协作者光标**:
- 显示: 其他协作者的位置
- 颜色: 协作者唯一颜色
- 标签: 协作者名字

**评论标记**:
- 位置: 评论时间点
- 图标: 💬
- 点击: 展开/收起评论

**缩放级别**:
- Overview: 每像素 1000 采样点（全局视图）
- Detail: 每像素 100 采样点（标准视图）
- Zoom: 每像素 10 采样点（精确视图）

### 4. 标注列表

**显示内容**:
- 标注序号
- 时间区间
- 文本内容
- 标签数量
- 说话人
- 操作按钮

**交互**:
- 点击标注跳转到对应时间
- 点击"编辑"打开标注编辑器
- 拖拽调整时间区间

**操作按钮**:
- 编辑
- 删除
- 复制

### 5. 标注层管理

**显示内容**:
- 层名称
- 层类型
- 层颜色
- 可见性开关

**预设层**:

| 层名称 | 类型 | 颜色 |
|--------|------|------|
| 转写层 | transcript | 蓝色 |
| 说话人层 | speaker | 绿色 |
| 情感层 | emotion | 橙色 |
| 事件层 | event | 紫色 |
| 噪音层 | noise | 灰色 |

**交互**:
- 勾选/取消勾选切换可见性
- 点击层切换当前活动层
- 新建层创建自定义标注层

### 6. 说话人列表

**显示内容**:
- 说话人头像
- 说话人名称
- 说话人颜色

**交互**:
- 点击说话人过滤标注
- 右键编辑说话人信息
- 新建说话人创建新说话人

### 7. AI 处理进度

**显示内容**:
- AI 任务类型（ASR、说话人分离、噪音检测）
- 处理进度百分比
- 处理状态

**状态**:

| 状态 | 图标 | 颜色 |
|------|------|------|
| 待处理 | ⏸️ | 灰色 |
| 处理中 | 🔄 | 蓝色 |
| 已完成 | ✅ | 绿色 |
| 失败 | ❌ | 红色 |

**交互**:
- 点击查看详情打开 AI 处理详情面板

### 8. 在线协作

**显示内容**:
- 协作者头像
- 协作者名称
- 在线状态

**交互**:
- 点击协作者查看信息
- @ 协作者发送通知

### 9. 热力图

**类型**:

| 类型 | 说明 |
|------|------|
| 标注密度 | 显示标注密集程度 |
| 说话人分布 | 显示说话人时间分布 |
| 频谱 | 显示音频频率分布 |

**交互**:
- 点击热力图跳转到对应时间
- 悬停显示详细信息
- 切换热力图类型

**颜色**:
- 标注密度: 蓝 → 绿 → 黄 → 红（密度递增）
- 说话人分布: 不同颜色表示不同说话人
- 频谱: 蓝 → 绿 → 黄 → 红（能量递增）

### 10. 播放进度条

**显示内容**:
- 当前时间
- 总时长
- 进度条

**交互**:
- 拖动进度条跳转
- 点击进度条跳转

---

## 交互说明

### 创建标注

1. 在波形上按住鼠标左键开始拖拽
2. 拖拽过程中显示选择区域（高亮）
3. 松开鼠标完成选择
4. 自动弹出标注编辑面板
5. 填写标注信息后保存

### 编辑标注

1. 点击标注列表中的标注
2. 或点击波形上的标注色块
3. 打开标注编辑面板
4. 修改标注信息后保存

### 调整时间区间

1. 点击标注的边缘
2. 拖拽边缘调整起止时间
3. 或在编辑面板中输入精确时间

### 播放控制

| 快捷键 | 功能 |
|--------|------|
| 空格 | 播放/暂停 |
| Esc | 停止 |
| ← | 后退 5 秒 |
| → | 前进 5 秒 |
| Shift+← | 上一段标注 |
| Shift+→ | 下一段标注 |
| Home | 跳转到开头 |
| End | 跳转到结尾 |
| Ctrl+A | 设置 A 点 |
| Ctrl+B | 设置 B 点 |
| Ctrl+L | 开启/关闭循环 |

### 波形操作

| 操作 | 功能 |
|------|------|
| 滚轮 | 缩放波形 |
| 拖动波形 | 平移视图 |
| 双击 | 播放/暂停 |
| 右键 | 打开上下文菜单 |

### 协作功能

1. 实时显示协作者光标
2. 显示协作者选区
3. 实时同步标注修改
4. 评论系统

---

## 标注编辑器

### 编辑器布局

```
┌─────────────────────────────────────┐
│  编辑标注                    [×]   │
├─────────────────────────────────────┤
│  时间区间                            │
│  开始: [00:15.230]                  │
│  结束: [00:45.670]                  │
│                                     │
│  转写文本                            │
│  ┌─────────────────────────────┐   │
│  │ 大家好，我是张三。今天我们要 │   │
│  │ 讨论一下这个项目的进度。    │   │
│  │                             │   │
│  │                             │   │
│  └─────────────────────────────┘   │
│  [插入时间戳] [标记说话人]          │
│                                     │
│  说话人                              │
│  [张三 ▼] [+新建]                   │
│                                     │
│  标签                                │
│  [高兴] [中性] [专业] [+添加]       │
│                                     │
│  备注                                │
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  └─────────────────────────────┘   │
│                                     │
│  [取消]              [保存]         │
└─────────────────────────────────────┘
```

**字段**:
- 时间区间: 起始时间、结束时间
- 转写文本: 文本内容
- 说话人: 选择说话人
- 标签: 选择标签
- 备注: 补充说明

---

## 响应式设计

### 桌面端 (≥ 1024px)

- 右侧面板宽度: 320px
- 波形显示区: 自适应

### 平板端 (768px - 1023px)

- 右侧面板宽度: 280px
- 调整按钮尺寸

### 手机端 (< 768px)

- 右侧面板折叠，点击展开
- 波形显示区: 自适应

---

## 样式规范

### 字体

- 工具栏: PingFang SC, 14px
- 波形: -（图形）
- 标注列表: PingFang SC, 14px
- 面板: PingFang SC, 14px

### 间距

- 工具栏高度: 56px
- 分段导航高度: 120px
- 波形显示区高度: 300px
- 热力图高度: 60px
- 进度条高度: 24px

### 颜色

- 工具栏背景: `#FFFFFF`
- 波形背景: `#FFFFFF`
- 波形颜色: `#409EFF`
- 标注色块: 根据层颜色
- 主色: `#409EFF`

---

## 浏览器兼容性

| 浏览器 | 版本要求 |
|--------|---------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

---

**原型设计完成**