# 标注界面 - 原型设计（上中下布局）⭐

> **页面路径**: `/audio/:id/annotate`
> **优先级**: P0
> **访问角色**: 标注员、审核员
> **布局**: 上中下垂直布局

---

## 页面布局（整体结构）

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ 顶部导航栏                                                                                           │
│ Audio Label Pro | 首页 | 音频列表 | 标注工作台 | 任务管理 | 用户头像                                        │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ 【顶部区域】长文本显示区（标注文本编辑器）                                                             │
│ ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│ │ 工具栏：[B] [I] [插入时间戳⏱] [标记说话人👤] [非语音标记🔇] [💾保存] [✅提交审核]            │ │
│ ├─────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│ │ ┌───────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│ │ │ [00:00.000]                                                                                     │ │ │
│ │ │ [👤说话人A] 大家好，欢迎参加今天的会议。今天我们要讨论项目的进展情况。                             │ │ │
│ │ │                                                                                               │ │ │
│ │ │ [00:15.230]                                                                                    │ │ │
│ │ │ [👤说话人B] 谢谢主持人。首先我来汇报一下上周的工作成果。我们完成了用户注册模块的开发。            │ │ │
│ │ │                                                                                               │ │ │
│ │ │ [00:35.670]                                                                                    │ │ │
│ │ │ [👤说话人A] 很好。那么接下来的一周有什么计划吗？                                                   │ │ │
│ │ │                                                                                               │ │ │
│ │ │ [00:42.150]                                                                                    │ │ │ │
│ │ │ [👤说话人B] 我们计划开始开发音频上传功能。预计需要两天时间。                                       │ │ │
│ │ │                                                                                               │ │ │
│ │ │ [00:58.940]                                                                                    │ │ │
│ │ │ [🔇噪音背景音...]                                                                              │ │ │
│ │ │                                                                                               │ │ │
│ │ │ [01:12.780]                                                                                    │ │ │
│ │ │ [👤说话人A] 好的。另外关于AI转写功能的优化，有没有遇到什么问题？                                  │ │ │
│ │ │                                                                                               │ │ │
│ │ └───────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│ 字数统计: 248 字 | 标注数: 6 个 | 保存状态: 已保存                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ 【中部区域】波形显示区（最大宽度显示）                                                                │
│ ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│ │ 工具栏：[◀放大] [▶缩小] [↺重置] [适应窗口] | 当前视图: 00:00 - 01:23                          │ │
│ ├─────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│ │ ┌───────────────────────────────────────────────────────────────────────────────────────────┐ │ │
│ │ │   00:00  ────────────────────────────────────────────────────────────  01:23              │ │ │
│ │ │                                                                                               │ │ │
│ │ │     ▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌│ │ │
│ │ │     │   [标注1-说话人A]        [标注2-说话人B]        [标注3-说话人A]   │                     │ │ │
│ │ │     │   00:00-00:15            00:15-00:35            00:35-00:42      │                     │ │ │
│ │ │     ▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌▌│ │ │
│ │ │                                                                                               │ │ │
│ │ │     协作者光标: [李四📍00:25.340] [王五📍00:45.890]                                          │ │ │
│ │ │     评论标记: 💬(2) 🔖(3)                                                                     │ │ │
│ │ │     A-B循环: A[00:15.230] ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ B[00:35.670]│ │ │
│ │ │                                                                                               │ │ │
│ │ │     当前播放位置: ████████████████████████████████████████████████████████████████████████▌00:58.940│ │ │
│ │ │                                                                                               │ │ │
│ │ │                                                                                               │ │ │
│ │ └───────────────────────────────────────────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────────────────────────────────────────────┘ │
│ 热力图: [标注密度▼] [说话人分布▼] [频谱▼]                                                          │
│ ▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂▂▃▅▆▇█▇▆▅▃▂                                                      │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ 【底部区域】功能控制区                                                                               │
│ ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│ │ 播放控制 │ 音频元数据 │ 标注层管理 │ 说话人列表 │ AI处理进度 │ 在线协作 │ 快捷操作               │ │
│ ├─────────────────────────────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                                               │ │
│ │ 播放控制:        音频元数据:           标注层管理:      说话人列表:        AI处理进度:            │ │
│ │ [⏮上一段]        文件名: meeting001.mp3  ☑转写层        👤张三(蓝)        🔄 ASR 85%           │ │
│ │ [▶播放/暂停]      时长: 01:23:450        ☑说话人层      👤李四(绿)        🔄 说话人分离 72%      │ │
│ │ [⏹停止]           文件大小: 12.5MB       ☑情感层        👤王五(橙)        🔄 标签推荐 60%       │
│ │ [⏭下一段]         格式: MP3             ☑事件层        [+新建]           [查看详情]            │
│ │ [⏸循环A-B]        采样率: 44100Hz       ☑噪音层                                           │ │
│ │ [速度:1.0x▼]      声道: 立体声           [+新建层]                                           │ │
│ │ [🔊音量]           比特率: 320kbps                                                           │ │
│ │                    创建时间: 2024-01-15                                                       │ │
│ │                                                                                               │ │
│ │ 在线协作:          快捷操作:                                                                 │ │
│ │ [头像]张三 在线     [新建标注] [批量AI处理] [导出数据] [版本历史] [帮助文档]                   │ │
│ │ [头像]李四 在线                                                                               │ │
│ │ [头像]王五 在线                                                                               │ │
│ │                                                                                               │ │
│ └─────────────────────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘

进度条: 00:58.940 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 01:23.450
         ████████████████████████████████████████████████████████████████████████████████████████████████░░░░ 78%
```

---

## 布局说明

### 整体布局原则

**设计理念**: 上中下垂直布局，信息层次清晰，操作便捷

- **顶部区域（30%高度）**: 长文本显示区，类似 textarea，用于显示和编辑音频标注文本内容
- **中部区域（50%高度）**: 波形显示区，最大宽度显示音频波形，支持缩放和平移
- **底部区域（20%高度）**: 功能控制区，包含播放控制、音频元数据、标注管理等所有标注功能

### 布局优势

1. **信息清晰**: 文本内容在上，波形在中，控制在下，层次分明
2. **操作便捷**: 底部集中所有控制按钮，减少上下切换
3. **视觉舒适**: 波形区域最大化，便于精确标注
4. **符合习惯**: 类似传统文档编辑器布局，用户上手快

---

## 组件详细说明

### 1. 顶部导航栏

**高度**: 56px

**功能**: 全局导航，快速切换页面

**内容**:
- Logo 和产品名称
- 导航链接（首页、音频列表、标注工作台、任务管理）
- 用户头像和下拉菜单

---

### 2. 顶部区域 - 长文本显示区 ⭐ 核心组件

**高度**: 300px（可调整）

**功能**: 显示和编辑音频标注文本内容

**组件构成**:

#### 2.1 工具栏

**位置**: 文本区域顶部

**按钮列表**:

| 按钮 | 图标 | 快捷键 | 功能 |
|------|------|--------|------|
| 加粗 | B | Ctrl+B | 加粗选中文本 |
| 斜体 | I | Ctrl+I | 斜体选中文本 |
| 插入时间戳 | ⏱ | Ctrl+T | 在光标位置插入当前播放时间 |
| 标记说话人 | 👤 | Ctrl+Shift+S | 标记选中文本的说话人 |
| 非语音标记 | 🔇 | Ctrl+Shift+N | 标记非语音片段 |
| 保存 | 💾 | Ctrl+S | 保存当前标注 |
| 提交审核 | ✅ | - | 提交标注到审核 |

#### 2.2 文本编辑器

**类型**: 类似 textarea 的富文本编辑器

**特性**:
- 支持多行文本输入
- 支持格式化（加粗、斜体）
- 支持时间戳插入（点击时间戳可跳转到对应位置）
- 支持说话人标记（显示为不同颜色）
- 支持非语音标记（显示为灰色）
- 支持自动保存（防丢失）
- 支持撤销/重做（Ctrl+Z / Ctrl+Y）

**时间戳格式**: `[HH:MM:SS.mmm]`

**说话人标记格式**: `[👤说话人名称]`

**非语音标记格式**: `[🔇噪音类型...]`

**文本内容示例**:

```
[00:00.000]
[👤主持人] 大家好，欢迎参加今天的会议。

[00:15.230]
[👤张三] 谢谢主持人。首先我来汇报一下工作。

[00:35.670]
[🔇背景音...]

[00:42.150]
[👤李四] 好的，接下来我们讨论...
```

#### 2.3 状态栏

**位置**: 文本区域底部

**显示内容**:
- 字数统计
- 标注数量
- 保存状态（已保存/未保存）

---

### 3. 中部区域 - 波形显示区 ⭐ 核心组件

**高度**: 400px（可调整）

**功能**: 显示音频波形和标注信息

**组件构成**:

#### 3.1 工具栏

**位置**: 波形区域顶部

**按钮列表**:

| 按钮 | 图标 | 快捷键 | 功能 |
|------|------|--------|------|
| 放大 | ◀ | + / = | 放大波形 |
| 缩小 | ▶ | - | 缩小波形 |
| 重置 | ↺ | Ctrl+0 | 重置为默认视图 |
| 适应窗口 | - | - | 自动调整波形大小 |

**视图信息**: 显示当前视图的时间范围（如 00:00 - 01:23）

#### 3.2 波形画布

**类型**: Canvas 绘制的音频波形

**特性**:
- 显示音频波形
- 显示标注色块（根据标注层或说话人）
- 显示当前播放位置
- 显示协作者光标
- 显示评论标记
- 显示 A-B 循环标记

**交互**:

| 操作 | 功能 |
|------|------|
| 点击波形 | 跳转到对应时间 |
| 拖拽选区 | 创建/调整标注 |
| 滚轮 | 缩放波形 |
| 拖动波形 | 平移视图 |
| 双击 | 播放/暂停 |
| 右键 | 打开上下文菜单 |

**标注色块**:
- 颜色: 根据标注层或说话人
- 边框: 标注边界
- 悬停: 显示标注信息（时间、文本、说话人、标签）

**协作者光标**:
- 显示: 其他协作者的位置
- 颜色: 协作者唯一颜色
- 标签: 协作者名字 + 时间

**评论标记**:
- 位置: 评论时间点
- 图标: 💬
- 点击: 展开/收起评论

**A-B 循环标记**:
- A 点: 绿色标记
- B 点: 红色标记
- 循环区域: 高亮显示

#### 3.3 当前播放位置

**显示**: 波形上的竖线指示器

**交互**: 拖动可跳转到任意位置

#### 3.4 热力图

**位置**: 波形区域底部

**类型**: 热力图条

**热力图类型**:

| 类型 | 说明 |
|------|------|
| 标注密度 | 显示标注密集程度 |
| 说话人分布 | 显示说话人时间分布 |
| 频谱 | 显示音频频率分布 |

**交互**:
- 点击热力图跳转到对应时间
- 悬停显示详细信息
- 切换热力图类型

**颜色**:
- 标注密度: 蓝 → 绿 → 黄 → 红（密度递增）
- 说话人分布: 不同颜色表示不同说话人
- 频谱: 蓝 → 绿 → 黄 → 红（能量递增）

---

### 4. 底部区域 - 功能控制区 ⭐ 核心组件

**高度**: 250px（可调整）

**功能**: 集中所有标注功能的控制面板

**组件构成**:

#### 4.1 播放控制

**位置**: 左侧

**功能**: 播放、暂停、停止、跳转等基础播放控制

**按钮列表**:

| 按钮 | 图标 | 快捷键 | 功能 |
|------|------|--------|------|
| 上一段 | ⏮ | Shift+← | 跳转到上一段标注 |
| 播放/暂停 | ▶/⏸ | 空格 | 播放/暂停 |
| 停止 | ⏹ | Esc | 停止播放 |
| 下一段 | ⏭ | Shift+→ | 跳转到下一段标注 |
| 循环A-B | ⏸ | Ctrl+L | 开启/关闭循环播放 |
| 速度 | 1.0x▼ | [ / ] | 选择播放速度 |
| 音量 | 🔊 | ↑ / ↓ / M | 调节音量 |

**播放速度选项**: 0.5x、0.75x、1.0x、1.25x、1.5x、2.0x

#### 4.2 音频元数据

**位置**: 中间

**功能**: 显示音频文件的基本信息

**显示内容**:

| 项目 | 说明 |
|------|------|
| 文件名 | meeting001.mp3 |
| 时长 | 01:23:450 |
| 文件大小 | 12.5MB |
| 格式 | MP3 |
| 采样率 | 44100Hz |
| 声道 | 立体声 |
| 比特率 | 320kbps |
| 创建时间 | 2024-01-15 |

#### 4.3 标注层管理

**位置**: 中间

**功能**: 管理多个标注层，控制各层的显示/隐藏

**预设层**:

| 层名称 | 类型 | 颜色 | 默认可见 |
|--------|------|------|----------|
| 转写层 | transcript | 蓝色 | ✅ |
| 说话人层 | speaker | 绿色 | ✅ |
| 情感层 | emotion | 橙色 | ✅ |
| 事件层 | event | 紫色 | ✅ |
| 噪音层 | noise | 灰色 | ✅ |

**交互**:
- 勾选/取消勾选切换可见性
- 点击层切换当前活动层
- 新建层创建自定义标注层

#### 4.4 说话人列表

**位置**: 中间

**功能**: 管理说话人信息

**显示内容**:
- 说话人头像
- 说话人名称
- 说话人颜色

**交互**:
- 点击说话人过滤标注
- 右键编辑说话人信息
- 新建说话人创建新说话人

#### 4.5 AI 处理进度

**位置**: 右侧

**功能**: 显示 AI 处理任务的进度

**显示内容**:

| 任务类型 | 进度 | 状态 |
|---------|------|------|
| ASR | 85% | 🔄 处理中 |
| 说话人分离 | 72% | 🔄 处理中 |
| 标签推荐 | 60% | 🔄 处理中 |

**状态图标**:

| 状态 | 图标 | 颜色 |
|------|------|------|
| 待处理 | ⏸️ | 灰色 |
| 处理中 | 🔄 | 蓝色 |
| 已完成 | ✅ | 绿色 |
| 失败 | ❌ | 红色 |

**交互**: 点击查看详情打开 AI 处理详情面板

#### 4.6 在线协作

**位置**: 右侧

**功能**: 显示当前在线的协作者

**显示内容**:
- 协作者头像
- 协作者名称
- 在线状态

**交互**:
- 点击协作者查看信息
- @ 协作者发送通知

#### 4.7 快捷操作

**位置**: 右侧

**功能**: 常用操作快捷入口

**按钮列表**:

| 按钮 | 功能 |
|------|------|
| 新建标注 | 创建新的标注 |
| 批量AI处理 | 批量启动AI处理 |
| 导出数据 | 导出标注数据 |
| 版本历史 | 查看版本历史 |
| 帮助文档 | 打开帮助文档 |

---

### 5. 进度条

**位置**: 页面最底部

**功能**: 显示当前播放进度

**显示内容**:
- 当前时间
- 总时长
- 进度条

**交互**:
- 拖动进度条跳转
- 点击进度条跳转

---

## 交互说明

### 创建标注

1. 在波形上按住鼠标左键开始拖拽
2. 拖拽过程中显示选择区域（高亮）
3. 松开鼠标完成选择
4. 自动在文本编辑器中插入时间戳
5. 在文本编辑器中输入标注内容
6. 可选：标记说话人、添加标签

### 编辑标注

1. 在文本编辑器中点击时间戳
2. 波形跳转到对应位置
3. 修改文本内容
4. 可选：调整时间区间、修改说话人、修改标签

### 删除标注

1. 在文本编辑器中选中标注内容
2. 按 Delete 键
3. 或右键选择删除

### 调整时间区间

1. 在波形上点击标注的边缘
2. 拖拽边缘调整起止时间
3. 文本编辑器中的时间戳自动更新

### 播放控制

| 快捷键 | 功能 |
|--------|------|
| 空格 | 播放/暂停 |
| Esc | 停止 |
| ← | 后退 5 秒 |
| → | 前进 5 秒 |
| Shift+← | 上一段标注 |
| Shift+→ | 下一段标注 |
| Home | 跳转到开头 |
| End | 跳转到结尾 |
| Ctrl+A | 设置 A 点 |
| Ctrl+B | 设置 B 点 |
| Ctrl+L | 开启/关闭循环 |
| ↑ | 音量增加 10% |
| ↓ | 音量减少 10% |
| M | 静音/取消静音 |

### 波形操作

| 操作 | 功能 |
|------|------|
| 滚轮 | 缩放波形 |
| 拖动波形 | 平移视图 |
| 双击 | 播放/暂停 |
| 右键 | 打开上下文菜单 |

### 文本编辑

| 快捷键 | 功能 |
|--------|------|
| Ctrl+T | 插入时间戳 |
| Ctrl+Shift+S | 标记说话人 |
| Ctrl+Shift+N | 非语音标记 |
| Ctrl+B | 加粗 |
| Ctrl+I | 斜体 |
| Ctrl+Z | 撤销 |
| Ctrl+Y | 重做 |
| Ctrl+S | 保存 |

### 协作功能

1. 实时显示协作者光标
2. 显示协作者选区
3. 实时同步标注修改
4. 评论系统

---

## 长音频场景优化

### 音频分块导航

**显示条件**: 音频时长 ≥ 30分钟

**位置**: 波形区域左侧

**内容**:
- 分段时间范围
- 分段标题（AI 生成或手动编辑）
- 分段摘要（AI 生成）

**交互**:
- 点击分段跳转到对应时间
- 右键编辑分段信息
- 拖拽调整分段顺序

**样式**:
- 当前播放分段高亮
- 未播放分段灰色

### 多级波形渲染

**缩放级别**:
- Overview（概览级）: 每像素 1000 采样点
- Detail（详细级）: 每像素 100 采样点
- Zoom（缩放级）: 每像素 10 采样点

**瓦片加载**:
- 只渲染可见区域的波形瓦片
- 支持预加载前后各 2 个瓦片
- 滚动时动态加载新瓦片，释放旧瓦片

---

## 响应式设计

### 桌面端 (≥ 1024px)

- 顶部区域高度: 300px
- 中部区域高度: 400px
- 底部区域高度: 250px
- 波形显示区: 自适应宽度

### 平板端 (768px - 1023px)

- 顶部区域高度: 250px
- 中部区域高度: 350px
- 底部区域高度: 200px
- 部分按钮折叠

### 手机端 (< 768px)

- 顶部区域高度: 200px
- 中部区域高度: 300px
- 底部区域高度: 180px
- 右侧面板折叠，点击展开

---

## 样式规范

### 字体

- 导航栏: PingFang SC, 14px
- 文本编辑器: PingFang SC, 14px
- 波形: -（图形）
- 工具栏: PingFang SC, 14px
- 面板: PingFang SC, 14px

### 间距

- 导航栏高度: 56px
- 顶部区域高度: 300px
- 中部区域高度: 400px
- 底部区域高度: 250px
- 工具栏高度: 40px
- 热力图高度: 60px
- 进度条高度: 24px

### 颜色

- 主色: `#409EFF`
- 成功色: `#67C23A`
- 警告色: `#E6A23C`
- 危险色: `#F56C6C`
- 信息色: `#909399`
- 文本色: `#303133`
- 边框色: `#DCDFE6`
- 背景色: `#FFFFFF`
- 波形颜色: `#409EFF`
- 标注色块: 根据层颜色

---

## 浏览器兼容性

| 浏览器 | 版本要求 |
|--------|---------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

---

## 性能指标

| 指标 | 要求 |
|------|------|
| 页面加载时间 | < 3秒 |
| 波形渲染时间 | < 2秒 |
| 文本编辑响应 | < 100ms |
| 实时同步延迟 | < 500ms |
| 内存占用 | < 300MB |

---

**原型设计完成**

**设计亮点**:
1. ✅ 上中下布局清晰，信息层次分明
2. ✅ 顶部文本编辑器支持富文本和时间戳
3. ✅ 中部波形最大化显示，便于精确标注
4. ✅ 底部集中所有控制按钮，操作便捷
5. ✅ 支持长音频场景优化
6. ✅ 支持实时协作
7. ✅ 支持AI辅助功能